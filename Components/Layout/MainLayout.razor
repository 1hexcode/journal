@using Journal.Components.Buttons
@using Journal.Services
@inherits LayoutComponentBase

@layout ParentLayout
@inject AuthService AuthService

<MudPopoverProvider />

<MudAppBar Color="Color.Surface" Elevation="0">
    <MudIconButton Icon="@Icons.Material.Filled.Menu" 
                   Color="@(IsDarkMode ? Color.Primary : Color.Default)" 
                   Edge="Edge.Start"
                   OnClick="@((e) => DrawerToggle())" />
    <MudText Style="font-weight: bold; font-size: 16px" Color="Color.Primary">@_title</MudText>
    <MudSpacer />
    <MudStack Row="true" Justify="Justify.Center" AlignItems="AlignItems.Center">
        <MudTooltip Text="Username">
            <MudChip T="string" 
                     Icon="@Icons.Material.Filled.AccountCircle" 
                     Color="@(IsDarkMode ? Color.Default : Color.Dark)">
                <MudText Typo="Typo.body1">@AuthService.CurrentUser.Username</MudText>
            </MudChip>
        </MudTooltip>
        <DarkModeButton />
        <StreakButton />
        <ReminderButton />
        <LogoutButton />
    </MudStack>
</MudAppBar>
<MudDrawer @bind-Open="@_drawerOpen">
    <NavMenu />
</MudDrawer>
<MudMainContent>
    <CascadingValue Value="SetAppBarTitle">
        @Body
    </CascadingValue>
</MudMainContent>